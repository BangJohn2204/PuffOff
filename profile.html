<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profil - PuffOff</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* CSS akan ditambahkan di sini */
    </style>
</head>
<body data-theme="default">
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1><i class="fas fa-user"></i> Profil Saya</h1>
            <p>Kelola informasi dan progress Anda</p>
        </div>

        <!-- Profile Card -->
        <div class="profile-card">
            <div class="profile-avatar" onclick="changeAvatar()">
                <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face&auto=format" 
                     alt="Profile Avatar" id="profileImage">
                <div class="avatar-edit">
                    <i class="fas fa-camera"></i>
                </div>
                <div class="health-indicator level-4" id="healthIndicator"></div>
            </div>
            <div class="profile-info">
                <h2 class="profile-name" id="profileName">Ahmad Wijaya</h2>
                <p class="profile-status" id="profileStatus">Pejuang Bebas Rokok</p>
                <div class="profile-badges">
                    <div class="badge main-badge">
                        <i class="fas fa-trophy"></i>
                        <span id="mainBadge">Week Warrior</span>
                    </div>
                    <div class="badge level-badge">
                        <i class="fas fa-star"></i>
                        <span>Level <span id="userLevel">4</span></span>
                    </div>
                    <div class="badge theme-badge">
                        <i class="fas fa-palette"></i>
                        <span id="currentTheme">Default</span>
                    </div>
                </div>
            </div>
            <div class="profile-actions">
                <button class="edit-btn" onclick="openEditProfile()">
                    <i class="fas fa-edit"></i>
                    Edit Profil
                </button>
                <button class="theme-btn" onclick="openThemeSelector()">
                    <i class="fas fa-palette"></i>
                </button>
            </div>
        </div>

        <!-- Quick Stats -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">üî•</div>
                <div class="stat-value" id="streakDays">7</div>
                <div class="stat-label">Hari Bebas</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üí∞</div>
                <div class="stat-value" id="totalSavings">Rp 210K</div>
                <div class="stat-label">Total Hemat</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üö´</div>
                <div class="stat-value" id="cigarettesAvoided">84</div>
                <div class="stat-label">Rokok Dihindari</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">‚ù§Ô∏è</div>
                <div class="stat-value" id="healthScore">78%</div>
                <div class="stat-label">Health Score</div>
            </div>
        </div>

        <!-- Friends & Community Section -->
        <div class="section">
            <div class="section-title">
                <div>
                    <i class="section-icon fas fa-users"></i>
                    Teman & Komunitas
                </div>
                <div class="friend-actions">
                    <button class="action-icon-btn" onclick="findFriends()" title="Cari Teman">
                        <i class="fas fa-search"></i>
                    </button>
                    <button class="action-icon-btn" onclick="shareProfile()" title="Bagikan Profil">
                        <i class="fas fa-share-alt"></i>
                    </button>
                </div>
            </div>
            
            <div class="referral-card">
                <div class="referral-info">
                    <div class="referral-label">Kode Referral Anda:</div>
                    <div class="referral-code" onclick="copyReferralCode()">
                        <span id="referralCode">AHMAD2024</span>
                        <i class="fas fa-copy"></i>
                    </div>
                </div>
                <button class="invite-btn" onclick="inviteFriends()">
                    <i class="fas fa-user-plus"></i>
                    Undang
                </button>
            </div>

            <div class="friends-list">
                <div class="friend-item">
                    <div class="friend-avatar">
                        <img src="https://images.unsplash.com/photo-1494790108755-2616b612e906?w=50&h=50&fit=crop&crop=face&auto=format" alt="Sarah">
                        <div class="friend-status online"></div>
                    </div>
                    <div class="friend-info">
                        <div class="friend-name">Sarah Putri</div>
                        <div class="friend-progress">14 hari bebas rokok</div>
                        <div class="friend-progress-bar">
                            <div class="progress-fill" style="width: 70%"></div>
                        </div>
                    </div>
                    <div class="friend-actions">
                        <button class="support-btn" onclick="sendSupport('sarah')" title="Kirim Dukungan">
                            <i class="fas fa-heart"></i>
                        </button>
                        <button class="challenge-btn" onclick="sendChallenge('sarah')" title="Tantang">
                            <i class="fas fa-fire"></i>
                        </button>
                    </div>
                </div>

                <div class="friend-item">
                    <div class="friend-avatar">
                        <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=50&h=50&fit=crop&crop=face&auto=format" alt="Budi">
                        <div class="friend-status offline"></div>
                    </div>
                    <div class="friend-info">
                        <div class="friend-name">Budi Santoso</div>
                        <div class="friend-progress">21 hari bebas rokok</div>
                        <div class="friend-progress-bar">
                            <div class="progress-fill" style="width: 85%"></div>
                        </div>
                    </div>
                    <div class="friend-actions">
                        <button class="support-btn" onclick="sendSupport('budi')" title="Kirim Dukungan">
                            <i class="fas fa-heart"></i>
                        </button>
                        <button class="challenge-btn" onclick="sendChallenge('budi')" title="Tantang">
                            <i class="fas fa-fire"></i>
                        </button>
                    </div>
                </div>

                <div class="friend-item">
                    <div class="friend-avatar">
                        <img src="https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=50&h=50&fit=crop&crop=face&auto=format" alt="Rina">
                        <div class="friend-status online"></div>
                    </div>
                    <div class="friend-info">
                        <div class="friend-name">Rina Maharani</div>
                        <div class="friend-progress">3 hari bebas rokok</div>
                        <div class="friend-progress-bar">
                            <div class="progress-fill" style="width: 30%"></div>
                        </div>
                    </div>
                    <div class="friend-actions">
                        <button class="support-btn" onclick="sendSupport('rina')" title="Kirim Dukungan">
                            <i class="fas fa-heart"></i>
                        </button>
                        <button class="challenge-btn" onclick="sendChallenge('rina')" title="Tantang">
                            <i class="fas fa-fire"></i>
                        </button>
                    </div>
                </div>
            </div>

            <div class="leaderboard">
                <h4>üèÜ Leaderboard Mingguan</h4>
                <div class="leaderboard-list">
                    <div class="leaderboard-item rank-1">
                        <div class="rank-badge">1</div>
                        <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=36&h=36&fit=crop&crop=face&auto=format" alt="Budi">
                        <div class="leaderboard-info">
                            <div class="name">Budi Santoso</div>
                            <div class="score">21 hari streak</div>
                        </div>
                        <div class="crown">üëë</div>
                    </div>
                    <div class="leaderboard-item rank-2">
                        <div class="rank-badge">2</div>
                        <img src="https://images.unsplash.com/photo-1494790108755-2616b612e906?w=36&h=36&fit=crop&crop=face&auto=format" alt="Sarah">
                        <div class="leaderboard-info">
                            <div class="name">Sarah Putri</div>
                            <div class="score">14 hari streak</div>
                        </div>
                        <div class="medal">ü•à</div>
                    </div>
                    <div class="leaderboard-item rank-3">
                        <div class="rank-badge">3</div>
                        <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=36&h=36&fit=crop&crop=face&auto=format" alt="Ahmad">
                        <div class="leaderboard-info">
                            <div class="name">Ahmad Wijaya (Anda)</div>
                            <div class="score">7 hari streak</div>
                        </div>
                        <div class="medal">ü•â</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Smoking History Section -->
        <div class="section">
            <div class="section-title">
                <div>
                    <i class="section-icon fas fa-history"></i>
                    Riwayat Merokok
                </div>
            </div>
            <div class="smoking-history" id="smokingHistorySection">
                <div class="history-summary" id="historySummary">
                    <div class="summary-item">
                        <span class="summary-label">Rokok per Hari</span>
                        <span class="summary-value" id="cigarettesPerDay">12 batang</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Biaya per Hari</span>
                        <span class="summary-value" id="costPerDay">Rp 30,000</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Lama Merokok</span>
                        <span class="summary-value" id="smokingDuration">5 tahun</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Total Dihabiskan</span>
                        <span class="summary-value" id="totalSpent">Rp 54,750,000</span>
                    </div>
                </div>
                <button class="edit-history-btn" onclick="openSmokingHistory()">
                    <i class="fas fa-edit"></i>
                    Edit Riwayat Merokok
                </button>
            </div>
        </div>

        <!-- Journey Timeline -->
        <div class="section">
            <div class="section-title">
                <div>
                    <i class="section-icon fas fa-route"></i>
                    Timeline Perjalanan
                </div>
            </div>
            <div class="journey-timeline">
                <div class="timeline-item completed">
                    <div class="timeline-dot"></div>
                    <div class="timeline-content">
                        <div class="timeline-title">Memulai Perjalanan üåü</div>
                        <div class="timeline-desc">Bergabung dengan PuffOff dan berkomitmen berhenti merokok</div>
                        <div class="timeline-date">15 Januari 2024</div>
                    </div>
                </div>
                <div class="timeline-item completed">
                    <div class="timeline-dot"></div>
                    <div class="timeline-content">
                        <div class="timeline-title">Minggu Pertama! üèÜ</div>
                        <div class="timeline-desc">Berhasil mencapai 7 hari bebas rokok</div>
                        <div class="timeline-date">22 Januari 2024</div>
                    </div>
                </div>
                <div class="timeline-item upcoming">
                    <div class="timeline-dot"></div>
                    <div class="timeline-content">
                        <div class="timeline-title">Target 2 Minggu üéØ</div>
                        <div class="timeline-desc">Menuju pencapaian 14 hari bebas rokok</div>
                        <div class="timeline-date">29 Januari 2024</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Health Recovery -->
        <div class="section">
            <div class="section-title">
                <div>
                    <i class="section-icon fas fa-heartbeat"></i>
                    Pemulihan Kesehatan
                </div>
            </div>
            <div class="health-recovery">
                <div class="health-score-display">
                    <div class="health-circle">
                        <div class="circle-progress" data-score="78"></div>
                        <div class="circle-content">
                            <span class="score-number">78</span>
                            <span class="score-label">Health Score</span>
                        </div>
                    </div>
                </div>
                <div class="health-metrics">
                    <div class="health-metric improving">
                        <div class="metric-icon">ü´Å</div>
                        <div class="metric-info">
                            <div class="metric-title">Fungsi Paru</div>
                            <div class="metric-status">Membaik 15%</div>
                            <div class="metric-progress">
                                <div class="progress-bar" style="width: 75%"></div>
                            </div>
                        </div>
                    </div>
                    <div class="health-metric improving">
                        <div class="metric-icon">‚ù§Ô∏è</div>
                        <div class="metric-info">
                            <div class="metric-title">Kardiovaskular</div>
                            <div class="metric-status">Membaik 20%</div>
                            <div class="metric-progress">
                                <div class="progress-bar" style="width: 80%"></div>
                            </div>
                        </div>
                    </div>
                    <div class="health-metric normal">
                        <div class="metric-icon">üå¨Ô∏è</div>
                        <div class="metric-info">
                            <div class="metric-title">Oksigen</div>
                            <div class="metric-status">Normal 97%</div>
                            <div class="metric-progress">
                                <div class="progress-bar" style="width: 97%"></div>
                            </div>
                        </div>
                    </div>
                    <div class="health-metric excellent">
                        <div class="metric-icon">‚ö°</div>
                        <div class="metric-info">
                            <div class="metric-title">Energi</div>
                            <div class="metric-status">Meningkat 25%</div>
                            <div class="metric-progress">
                                <div class="progress-bar" style="width: 85%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Achievements -->
        <div class="section">
            <div class="section-title">
                <div>
                    <i class="section-icon fas fa-trophy"></i>
                    Pencapaian & Lencana
                </div>
            </div>
            <div class="achievements-grid">
                <div class="achievement-card earned" data-achievement="fire-starter" onclick="showAchievementDetail('fire-starter')">
                    <div class="achievement-icon">üî•</div>
                    <div class="achievement-title">Fire Starter</div>
                    <div class="achievement-desc">3 hari bebas rokok</div>
                </div>
                <div class="achievement-card earned" data-achievement="money-saver" onclick="showAchievementDetail('money-saver')">
                    <div class="achievement-icon">üí∞</div>
                    <div class="achievement-title">Money Saver</div>
                    <div class="achievement-desc">Hemat Rp 100K</div>
                </div>
                <div class="achievement-card earned" data-achievement="week-warrior" onclick="showAchievementDetail('week-warrior')">
                    <div class="achievement-icon">üèÉ</div>
                    <div class="achievement-title">Week Warrior</div>
                    <div class="achievement-desc">7 hari konsisten</div>
                </div>
                <div class="achievement-card locked">
                    <div class="achievement-icon">üëë</div>
                    <div class="achievement-title">Champion</div>
                    <div class="achievement-desc">30 hari bebas rokok</div>
                    <div class="achievement-progress">23%</div>
                </div>
                <div class="achievement-card locked">
                    <div class="achievement-icon">üíé</div>
                    <div class="achievement-title">Diamond</div>
                    <div class="achievement-desc">90 hari bebas rokok</div>
                    <div class="achievement-progress">8%</div>
                </div>
                <div class="achievement-card locked">
                    <div class="achievement-icon">üåü</div>
                    <div class="achievement-title">Legend</div>
                    <div class="achievement-desc">1 tahun bebas rokok</div>
                    <div class="achievement-progress">2%</div>
                </div>
            </div>
        </div>

        <!-- Savings Tracker -->
        <div class="section">
            <div class="section-title">
                <div>
                    <i class="section-icon fas fa-piggy-bank"></i>
                    Tracker Penghematan
                </div>
            </div>
            <div class="savings-tracker">
                <div class="savings-breakdown">
                    <div class="savings-item">
                        <div class="savings-period">Minggu Ini</div>
                        <div class="savings-amount">Rp 210K</div>
                    </div>
                    <div class="savings-item">
                        <div class="savings-period">Bulan Ini</div>
                        <div class="savings-amount">Rp 900K</div>
                    </div>
                    <div class="savings-item">
                        <div class="savings-period">Proyeksi Tahun</div>
                        <div class="savings-amount">Rp 10.8M</div>
                    </div>
                </div>
                
                <div class="savings-goals">
                    <h4>üéØ Target Penghematan</h4>
                    <div class="goals-list" id="goalsList">
                        <div class="goal-item">
                            <div class="goal-info">
                                <span class="goal-title">Smartphone Baru</span>
                                <span class="goal-target">Rp 3.000.000</span>
                            </div>
                            <div class="goal-progress">
                                <div class="goal-progress-bar" style="width: 7%"></div>
                                <span class="goal-percentage">7%</span>
                            </div>
                        </div>
                        <div class="goal-item">
                            <div class="goal-info">
                                <span class="goal-title">Liburan Keluarga</span>
                                <span class="goal-target">Rp 8.000.000</span>
                            </div>
                            <div class="goal-progress">
                                <div class="goal-progress-bar" style="width: 3%"></div>
                                <span class="goal-percentage">3%</span>
                            </div>
                        </div>
                    </div>
                    <button class="add-goal-btn" onclick="openAddGoal()">
                        <i class="fas fa-plus"></i>
                        Tambah Target Baru
                    </button>
                </div>
            </div>
        </div>

        <!-- Settings -->
        <div class="section">
            <div class="section-title">
                <div>
                    <i class="section-icon fas fa-cog"></i>
                    Pengaturan
                </div>
            </div>
            <div class="settings-list">
                <div class="setting-item" onclick="openNotificationSettings()">
                    <div class="setting-info">
                        <i class="fas fa-bell"></i>
                        <span>Notifikasi</span>
                    </div>
                    <i class="fas fa-chevron-right"></i>
                </div>
                <div class="setting-item" onclick="toggleTheme()">
                    <div class="setting-info">
                        <i class="fas fa-moon"></i>
                        <span>Mode Gelap</span>
                    </div>
                    <div class="setting-toggle">
                        <input type="checkbox" id="darkModeToggle">
                        <label for="darkModeToggle"></label>
                    </div>
                </div>
                <div class="setting-item" onclick="openDataManagement()">
                    <div class="setting-info">
                        <i class="fas fa-download"></i>
                        <span>Export Data</span>
                    </div>
                    <i class="fas fa-chevron-right"></i>
                </div>
                <div class="setting-item" onclick="shareProfile()">
                    <div class="setting-info">
                        <i class="fas fa-share-alt"></i>
                        <span>Bagikan Profil</span>
                    </div>
                    <i class="fas fa-chevron-right"></i>
                </div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
            <button class="action-btn btn-secondary" onclick="resetProgress()">
                <i class="fas fa-redo"></i>
                Reset Progress
            </button>
            <button class="action-btn btn-danger" onclick="confirmLogout()">
                <i class="fas fa-sign-out-alt"></i>
                Keluar
            </button>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <div class="bottom-nav">
        <div class="nav-container">
            <a href="home.html" class="nav-item">
                <i class="fas fa-home"></i>
                <span>Beranda</span>
            </a>
            <a href="progress.html" class="nav-item">
                <i class="fas fa-chart-bar"></i>
                <span>Progress</span>
            </a>
            <a href="chatbot.html" class="nav-item">
                <i class="fas fa-robot"></i>
                <span>AI Helper</span>
            </a>
            <a href="komunitas.html" class="nav-item">
                <i class="fas fa-users"></i>
                <span>Komunitas</span>
            </a>
            <a href="target.html" class="nav-item">
                <i class="fas fa-bullseye"></i>
                <span>Target</span>
            </a>
            <a href="profile.html" class="nav-item active">
                <i class="fas fa-user"></i>
                <span>Profil</span>
            </a>
        </div>
    </div>

    <!-- Theme Selection Modal -->
    <div class="modal" id="themeModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Pilih Tema</h3>
                <button class="modal-close" onclick="closeThemeSelector()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="theme-grid">
                    <div class="theme-option selected" data-theme="default" onclick="selectTheme('default')">
                        <div class="theme-preview">
                            <i class="fas fa-palette"></i>
                        </div>
                        <div class="theme-name">Default</div>
                    </div>
                    <div class="theme-option" data-theme="ocean" onclick="selectTheme('ocean')">
                        <div class="theme-preview">
                            <i class="fas fa-water"></i>
                        </div>
                        <div class="theme-name">Ocean</div>
                    </div>
                    <div class="theme-option" data-theme="forest" onclick="selectTheme('forest')">
                        <div class="theme-preview">
                            <i class="fas fa-tree"></i>
                        </div>
                        <div class="theme-name">Forest</div>
                    </div>
                    <div class="theme-option" data-theme="sunset" onclick="selectTheme('sunset')">
                        <div class="theme-preview">
                            <i class="fas fa-sun"></i>
                        </div>
                        <div class="theme-name">Sunset</div>
                    </div>
                    <div class="theme-option" data-theme="purple" onclick="selectTheme('purple')">
                        <div class="theme-preview">
                            <i class="fas fa-star"></i>
                        </div>
                        <div class="theme-name">Purple</div>
                    </div>
                    <div class="theme-option" data-theme="dark" onclick="selectTheme('dark')">
                        <div class="theme-preview">
                            <i class="fas fa-moon"></i>
                        </div>
                        <div class="theme-name">Dark</div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeThemeSelector()">Batal</button>
                <button class="btn btn-primary" onclick="applyTheme()">Terapkan</button>
            </div>
        </div>
    </div>

    <!-- Other existing modals remain the same -->
    <!-- Edit Profile Modal -->
    <div class="modal" id="editProfileModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Edit Profil</h3>
                <button class="modal-close" onclick="closeEditProfile()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Nama Lengkap</label>
                    <input type="text" id="editName" placeholder="Masukkan nama lengkap">
                </div>
                <div class="form-group">
                    <label>Status</label>
                    <input type="text" id="editStatus" placeholder="Masukkan status">
                </div>
                <div class="form-group">
                    <label>Bio</label>
                    <textarea id="editBio" placeholder="Ceritakan tentang perjalanan Anda"></textarea>
                </div>
                <div class="form-group">
                    <label>Tanggal Mulai Berhenti</label>
                    <input type="date" id="editStartDate">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeEditProfile()">Batal</button>
                <button class="btn btn-primary" onclick="saveProfile()">Simpan</button>
            </div>
        </div>
    </div>

    <!-- Smoking History Modal -->
    <div class="modal" id="smokingHistoryModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Riwayat Merokok</h3>
                <button class="modal-close" onclick="closeSmokingHistory()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Berapa batang rokok per hari sebelumnya?</label>
                    <input type="number" id="cigarettesPerDayInput" placeholder="Contoh: 12" min="1" max="100">
                    <small>Rata-rata jumlah rokok yang Anda konsumsi per hari</small>
                </div>
                <div class="form-group">
                    <label>Berapa harga per bungkus rokok?</label>
                    <input type="number" id="pricePerPackInput" placeholder="Contoh: 25000" min="1000">
                    <small>Harga rata-rata per bungkus (20 batang)</small>
                </div>
                <div class="form-group">
                    <label>Sudah berapa lama merokok?</label>
                    <div class="duration-inputs">
                        <input type="number" id="smokingYears" placeholder="0" min="0" max="50">
                        <span>tahun</span>
                        <input type="number" id="smokingMonths" placeholder="0" min="0" max="11">
                        <span>bulan</span>
                    </div>
                </div>
                <div class="calculation-preview" id="calculationPreview">
                    <h4>üìä Perkiraan Pengeluaran:</h4>
                    <div class="calculation-item">
                        <span>Per Hari:</span>
                        <span id="dailyCost">Rp 0</span>
                    </div>
                    <div class="calculation-item">
                        <span>Per Bulan:</span>
                        <span id="monthlyCost">Rp 0</span>
                    </div>
                    <div class="calculation-item">
                        <span>Per Tahun:</span>
                        <span id="yearlyCost">Rp 0</span>
                    </div>
                    <div class="calculation-item total">
                        <span>Total Selama Merokok:</span>
                        <span id="totalLifetimeCost">Rp 0</span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeSmokingHistory()">Batal</button>
                <button class="btn btn-primary" onclick="saveSmokingHistory()">Simpan</button>
            </div>
        </div>
    </div>

    <!-- Add Goal Modal -->
    <div class="modal" id="addGoalModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Tambah Target Penghematan</h3>
                <button class="modal-close" onclick="closeAddGoal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Nama Target</label>
                    <input type="text" id="goalName" placeholder="Contoh: Laptop Baru">
                </div>
                <div class="form-group">
                    <label>Jumlah Target (Rp)</label>
                    <input type="number" id="goalAmount" placeholder="Contoh: 5000000" min="1000">
                </div>
                <div class="form-group">
                    <label>Kategori</label>
                    <select id="goalCategory">
                        <option value="elektronik">Elektronik</option>
                        <option value="liburan">Liburan</option>
                        <option value="pendidikan">Pendidikan</option>
                        <option value="kesehatan">Kesehatan</option>
                        <option value="investasi">Investasi</option>
                        <option value="lainnya">Lainnya</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeAddGoal()">Batal</button>
                <button class="btn btn-primary" onclick="saveGoal()">Tambah Target</button>
            </div>
        </div>
    </div>

    <!-- Achievement Detail Modal -->
    <div class="modal" id="achievementModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="achievementTitle">Detail Pencapaian</h3>
                <button class="modal-close" onclick="closeAchievementDetail()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="achievement-detail">
                    <div class="achievement-icon-large" id="achievementIconLarge">üî•</div>
                    <div class="achievement-info">
                        <h4 id="achievementName">Fire Starter</h4>
                        <p id="achievementDescription">Selamat! Anda telah berhasil tidak merokok selama 3 hari berturut-turut.</p>
                        <div class="achievement-earned-date">
                            <i class="fas fa-calendar"></i>
                            <span id="achievementEarnedDate">Diraih pada: 16 Januari 2024</span>
                        </div>
                        <div class="achievement-tips" id="achievementTips">
                            <h5>üí° Tips:</h5>
                            <p>Terus pertahankan momentum ini dengan mengingat alasan mengapa Anda ingin berhenti merokok.</p>
                        </div>
                    </div>
                </div>
                <div class="achievement-actions">
                    <button class="btn btn-secondary" onclick="shareAchievement()">
                        <i class="fas fa-share-alt"></i>
                        Bagikan
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <p>Memuat data...</p>
    </div>

    <script>
        // Theme Management
        let selectedTheme = 'default';
        const themes = {
            'default': 'Default',
            'ocean': 'Ocean',
            'forest': 'Forest',
            'sunset': 'Sunset',
            'purple': 'Purple',
            'dark': 'Dark'
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadSavedTheme();
            updateThemeDisplay();
            setupEventListeners();
            calculateSmokingCosts();
        });

        function loadSavedTheme() {
            const savedTheme = localStorage.getItem('puffoff-theme') || 'default';
            selectedTheme = savedTheme;
            document.body.setAttribute('data-theme', savedTheme);
        }

        function updateThemeDisplay() {
            document.getElementById('currentTheme').textContent = themes[selectedTheme];
        }

        function openThemeSelector() {
            document.getElementById('themeModal').classList.add('show');
            // Update selected theme in modal
            document.querySelectorAll('.theme-option').forEach(option => {
                option.classList.remove('selected');
                if (option.dataset.theme === selectedTheme) {
                    option.classList.add('selected');
                }
            });
        }

        function closeThemeSelector() {
            document.getElementById('themeModal').classList.remove('show');
        }

        function selectTheme(theme) {
            selectedTheme = theme;
            document.querySelectorAll('.theme-option').forEach(option => {
                option.classList.remove('selected');
            });
            document.querySelector(`[data-theme="${theme}"]`).classList.add('selected');
        }

        function applyTheme() {
            document.body.setAttribute('data-theme', selectedTheme);
            localStorage.setItem('puffoff-theme', selectedTheme);
            updateThemeDisplay();
            closeThemeSelector();
            showToast('Tema berhasil diterapkan!', 'success');
        }

        // Profile Functions
        function changeAvatar() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        document.getElementById('profileImage').src = e.target.result;
                        showToast('Foto profil berhasil diubah!', 'success');
                    };
                    reader.readAsDataURL(file);
                }
            };
            input.click();
        }

        function openEditProfile() {
            document.getElementById('editProfileModal').classList.add('show');
            // Load current values
            document.getElementById('editName').value = document.getElementById('profileName').textContent;
            document.getElementById('editStatus').value = document.getElementById('profileStatus').textContent;
        }

        function closeEditProfile() {
            document.getElementById('editProfileModal').classList.remove('show');
        }

        function saveProfile() {
            const name = document.getElementById('editName').value;
            const status = document.getElementById('editStatus').value;
            
            if (name) document.getElementById('profileName').textContent = name;
            if (status) document.getElementById('profileStatus').textContent = status;
            
            closeEditProfile();
            showToast('Profil berhasil diperbarui!', 'success');
        }

        // Friends & Community Functions
        function copyReferralCode() {
            const code = document.getElementById('referralCode').textContent;
            navigator.clipboard.writeText(code).then(() => {
                showToast('Kode referral berhasil disalin!', 'success');
            });
        }

        function inviteFriends() {
            const code = document.getElementById('referralCode').textContent;
            if (navigator.share) {
                navigator.share({
                    title: 'Bergabung dengan PuffOff',
                    text: `Yuk berhenti merokok bareng! Gunakan kode referral saya: ${code}`,
                    url: window.location.origin
                });
            } else {
                copyReferralCode();
                showToast('Link undangan disalin! Bagikan ke teman Anda.', 'info');
            }
        }

        function findFriends() {
            showToast('Fitur pencarian teman akan segera hadir!', 'info');
        }

        function sendSupport(friendId) {
            showToast(`Dukungan berhasil dikirim!`, 'success');
            // Add heart animation effect
            event.target.style.transform = 'scale(1.2)';
            setTimeout(() => {
                event.target.style.transform = 'scale(1)';
            }, 200);
        }

        function sendChallenge(friendId) {
            showToast(`Tantangan berhasil dikirim!`, 'success');
            // Add fire animation effect
            event.target.style.transform = 'scale(1.2)';
            setTimeout(() => {
                event.target.style.transform = 'scale(1)';
            }, 200);
        }

        function shareProfile() {
            if (navigator.share) {
                navigator.share({
                    title: 'Profil PuffOff Saya',
                    text: 'Lihat progress saya dalam berhenti merokok!',
                    url: window.location.href
                });
            } else {
                navigator.clipboard.writeText(window.location.href);
                showToast('Link profil berhasil disalin!', 'success');
            }
        }

        // Smoking History Functions
        function openSmokingHistory() {
            document.getElementById('smokingHistoryModal').classList.add('show');
            setupCalculationListeners();
        }

        function closeSmokingHistory() {
            document.getElementById('smokingHistoryModal').classList.remove('show');
        }

        function setupCalculationListeners() {
            const inputs = ['cigarettesPerDayInput', 'pricePerPackInput', 'smokingYears', 'smokingMonths'];
            inputs.forEach(id => {
                document.getElementById(id).addEventListener('input', calculateSmokingCosts);
            });
        }

        function calculateSmokingCosts() {
            const cigarettesPerDay = parseInt(document.getElementById('cigarettesPerDayInput')?.value) || 0;
            const pricePerPack = parseInt(document.getElementById('pricePerPackInput')?.value) || 0;
            const years = parseInt(document.getElementById('smokingYears')?.value) || 0;
            const months = parseInt(document.getElementById('smokingMonths')?.value) || 0;

            const dailyCost = (cigarettesPerDay * pricePerPack) / 20;
            const monthlyCost = dailyCost * 30;
            const yearlyCost = dailyCost * 365;
            const totalMonths = (years * 12) + months;
            const totalLifetimeCost = (monthlyCost * totalMonths);

            if (document.getElementById('dailyCost')) {
                document.getElementById('dailyCost').textContent = formatCurrency(dailyCost);
                document.getElementById('monthlyCost').textContent = formatCurrency(monthlyCost);
                document.getElementById('yearlyCost').textContent = formatCurrency(yearlyCost);
                document.getElementById('totalLifetimeCost').textContent = formatCurrency(totalLifetimeCost);
            }
        }

        function saveSmokingHistory() {
            // Update display values
            const cigarettesPerDay = document.getElementById('cigarettesPerDayInput').value;
            const pricePerPack = document.getElementById('pricePerPackInput').value;
            
            if (cigarettesPerDay) {
                document.getElementById('cigarettesPerDay').textContent = cigarettesPerDay + ' batang';
                document.getElementById('costPerDay').textContent = formatCurrency((cigarettesPerDay * pricePerPack) / 20);
            }
            
            closeSmokingHistory();
            showToast('Riwayat merokok berhasil diperbarui!', 'success');
        }

        // Goals Functions
        function openAddGoal() {
            document.getElementById('addGoalModal').classList.add('show');
        }

        function closeAddGoal() {
            document.getElementById('addGoalModal').classList.remove('show');
        }

        function saveGoal() {
            const goalName = document.getElementById('goalName').value;
            const goalAmount = document.getElementById('goalAmount').value;
            
            if (!goalName || !goalAmount) {
                showToast('Harap isi semua field!', 'error');
                return;
            }
            
            // Add new goal to list (simplified implementation)
            const goalsList = document.getElementById('goalsList');
            const newGoal = document.createElement('div');
            newGoal.className = 'goal-item';
            newGoal.innerHTML = `
                <div class="goal-info">
                    <span class="goal-title">${goalName}</span>
                    <span class="goal-target">${formatCurrency(goalAmount)}</span>
                </div>
                <div class="goal-progress">
                    <div class="goal-progress-bar" style="width: 0%"></div>
                    <span class="goal-percentage">0%</span>
                </div>
            `;
            goalsList.appendChild(newGoal);
            
            closeAddGoal();
            showToast('Target berhasil ditambahkan!', 'success');
            
            // Clear form
            document.getElementById('goalName').value = '';
            document.getElementById('goalAmount').value = '';
        }

        // Achievement Functions
        function showAchievementDetail(achievementId) {
            const achievements = {
                'fire-starter': {
                    icon: 'üî•',
                    name: 'Fire Starter',
                    description: 'Selamat! Anda telah berhasil tidak merokok selama 3 hari berturut-turut.',
                    tips: 'Terus pertahankan momentum ini dengan mengingat alasan mengapa Anda ingin berhenti merokok.'
                },
                'money-saver': {
                    icon: 'üí∞',
                    name: 'Money Saver',
                    description: 'Hebat! Anda telah berhasil menghemat Rp 100.000 dari tidak membeli rokok.',
                    tips: 'Gunakan uang yang dihemat untuk hal-hal yang lebih bermanfaat seperti investasi atau hobi baru.'
                },
                'week-warrior': {
                    icon: 'üèÉ',
                    name: 'Week Warrior',
                    description: 'Luar biasa! Anda telah konsisten tidak merokok selama 7 hari penuh.',
                    tips: 'Minggu pertama adalah yang tersulit. Sekarang tubuh Anda mulai terbiasa tanpa nikotin.'
                }
            };

            const achievement = achievements[achievementId];
            if (achievement) {
                document.getElementById('achievementIconLarge').textContent = achievement.icon;
                document.getElementById('achievementName').textContent = achievement.name;
                document.getElementById('achievementDescription').textContent = achievement.description;
                document.getElementById('achievementTips').querySelector('p').textContent = achievement.tips;
                document.getElementById('achievementModal').classList.add('show');
            }
        }

        function closeAchievementDetail() {
            document.getElementById('achievementModal').classList.remove('show');
        }

        function shareAchievement() {
            const achievementName = document.getElementById('achievementName').textContent;
            if (navigator.share) {
                navigator.share({
                    title: `Pencapaian Baru: ${achievementName}`,
                    text: `Saya baru saja meraih pencapaian "${achievementName}" di PuffOff!`,
                    url: window.location.origin
                });
            } else {
                showToast('Pencapaian berhasil disalin untuk dibagikan!', 'success');
            }
        }

        // Settings Functions
        function openNotificationSettings() {
            showToast('Pengaturan notifikasi akan segera hadir!', 'info');
        }

        function toggleTheme() {
            const toggle = document.getElementById('darkModeToggle');
            const isDark = toggle.checked;
            
            if (isDark) {
                selectTheme('dark');
                applyTheme();
            } else {
                selectTheme('default');
                applyTheme();
            }
        }

        function openDataManagement() {
            showToast('Fitur export data akan segera hadir!', 'info');
        }

        // Action Functions
        function resetProgress() {
            if (confirm('Apakah Anda yakin ingin mereset semua progress? Tindakan ini tidak dapat dibatalkan.')) {
                showToast('Progress berhasil direset!', 'success');
                // Reset implementation would go here
            }
        }

        function confirmLogout() {
            if (confirm('Apakah Anda yakin ingin keluar?')) {
                showToast('Berhasil keluar. Sampai jumpa lagi!', 'info');
                setTimeout(() => {
                    window.location.href = 'login.html';
                }, 1500);
            }
        }

        // Utility Functions
        function formatCurrency(amount) {
            return new Intl.NumberFormat('id-ID', {
                style: 'currency',
                currency: 'IDR',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(amount);
        }

        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast ${type} show`;
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        function setupEventListeners() {
            // Close modals when clicking outside
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('modal')) {
                    e.target.classList.remove('show');
                }
            });

            // Update dark mode toggle based on theme
            const updateDarkModeToggle = () => {
                const toggle = document.getElementById('darkModeToggle');
                toggle.checked = selectedTheme === 'dark';
            };

            // Listen for theme changes
            const observer = new MutationObserver(updateDarkModeToggle);
            observer.observe(document.body, { attributes: true, attributeFilter: ['data-theme'] });
            updateDarkModeToggle();
        }

        // Add CSS
        const css = `${document.getElementById('profile_css').textContent}`;
        const style = document.createElement('style');
        style.textContent = css;
        document.head.appendChild(style);
    </script>
</body>
</html>
